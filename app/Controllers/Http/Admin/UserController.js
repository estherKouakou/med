"use strict";
const Database = use("Database");
const { validate } = use("Validator");

const User = use("App/Models/User");

class UserController {


  create({ view}) {
    return view.render("account");
  }

  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  //Récupération de donéées de la page de créeation de compte

  async createAccount({ response, request, auth }) {

    const user = await User.create(request.only(['username', 'email', 'password']));

    await auth.login(user);
    return response.redirect('/');

  }

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  login({ view }) {
    // const users = yield Database.select('*').from('users')
    return view.render("login");
  }

  async log({ request, response, session, auth }) {

    const { email, password } = request.all();

    try {
      await auth.attempt(email, password);
      return response.redirect('/');
    } catch (error) {
      session.flash({ loginError: 'These credentials do not work.' })
      return response.redirect('/login');
    }
    
  
  }

  
  index({ view }) {
    // console.log(session.get("med"));
    return view.render("welcome");
  }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  rdv({ view }) {
    return view.render("rdv");
  }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

 

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  med({ view }) {
    return view.render("medecin");
  }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  pat({ view }) {
    return view.render("patient");
  }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  pro({ view }) {
    return view.render("profil");
  }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

 

  error({ view }) {
    return view.render("error");
  }
}

module.exports = UserController;
